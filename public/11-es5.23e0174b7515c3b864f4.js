function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function _createClass(e,n,r){return n&&_defineProperties(e.prototype,n),r&&_defineProperties(e,r),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{nDdO:function(e,n,r){"use strict";r.r(n);var t,i,a=r("lGQG"),o=r("wHSu"),s=r("Rv5h"),c=r("vuBd"),l=r("QTu/"),u=r("Mb37"),d=r("fXoL"),b=r("qfBg"),m=r("tyNb"),p=r("NvMS"),f=r("ofXK"),g=r("FpAq"),h=r("3Pt+"),v=r("siFw"),y=r("6NWb"),x=r("Sa4M"),w=r("1kSV"),P=((i=function(){function e(n,r,t){_classCallCheck(this,e),this.modal=n,this.userService=r,this.router=t,this.isErrorDeleting=new d.m,this.loading=new d.m,this.firedOff=new d.m}return _createClass(e,[{key:"ngOnInit",value:function(){this.btnDisabled=!1}},{key:"deleteCurrentUser",value:function(){var e=this;this.firedOff.emit(!0),this.btnDisabled=!0,this.userService.deleteUser(JSON.parse(l.a.getCookie("user")).id).subscribe((function(){e.isErrorDeleting.emit(!1),e.loading.emit(!1),e.router.navigate(["/","home"]),a.a.logout()}),(function(n){e.btnDisabled=!1,e.loading.emit(!1),e.firedOff.emit(!1),e.isErrorDeleting.emit(!0),u.a.error(n)})),this.closeModal()}},{key:"closeModal",value:function(){this.modal.close("Ok click")}}]),e}()).\u0275fac=function(e){return new(e||i)(d.Lb(w.c),d.Lb(b.a),d.Lb(m.b))},i.\u0275cmp=d.Fb({type:i,selectors:[["app-account-modal"]],inputs:{username:"username"},outputs:{isErrorDeleting:"isErrorDeleting",loading:"loading",firedOff:"firedOff"},decls:25,vars:4,consts:[[1,"modal-header"],["id","modal-title",1,"modal-title"],["type","button","aria-describedby","modal-title",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"hidden"],[1,"modal-footer","justify-content-start"],["type","button","appBtn","","btnType","danger",3,"disabled","click"],["type","button","appBtn","","btnType","secondary-outline",3,"click"]],template:function(e,n){1&e&&(d.Ob(0),d.Rb(1,"div",0),d.Rb(2,"h4",1),d.Hc(3,"Account deletion"),d.Pb(),d.Rb(4,"button",2),d.dc("click",(function(e){return n.modal.dismiss("Cross click")})),d.Rb(5,"span",3),d.Hc(6,"\xd7"),d.Pb(),d.Pb(),d.Pb(),d.Rb(7,"div",4),d.Rb(8,"p"),d.Rb(9,"strong"),d.Hc(10,"Are you sure you want to delete your own account "),d.Rb(11,"span",5),d.Hc(12,"("),d.Pb(),d.Hc(13),d.Rb(14,"span",5),d.Hc(15,")"),d.Pb(),d.Hc(16,"?"),d.Pb(),d.Pb(),d.Rb(17,"p"),d.Rb(18,"span"),d.Hc(19,"This operation cannot be undone."),d.Pb(),d.Pb(),d.Pb(),d.Rb(20,"div",6),d.Rb(21,"button",7),d.dc("click",(function(e){return n.deleteCurrentUser()})),d.Hc(22," Ok "),d.Pb(),d.Rb(23,"button",8),d.dc("click",(function(e){return n.modal.dismiss("cancel click")})),d.Hc(24," Cancel "),d.Pb(),d.Pb(),d.Nb()),2&e&&(d.xb(11),d.nc("hidden",!n.username),d.xb(2),d.Ic(n.username||""),d.xb(1),d.nc("hidden",!n.username),d.xb(7),d.nc("disabled",n.btnDisabled))},directives:[v.a],styles:[".modal-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{color:red}"]}),i),C=((t=function(){function e(n){_classCallCheck(this,e),this.modalService=n,this.isError=new d.m}return _createClass(e,[{key:"ngOnInit",value:function(){this.loading=!1,this.btnText="Delete User!"}},{key:"confirmDeletion",value:function(){var e=this,n=this.modalService.open(P,{centered:!0});n.componentInstance.loading.subscribe((function(n){e.loading=n})),n.componentInstance.isErrorDeleting.subscribe((function(n){e.isError.emit(n)})),n.componentInstance.firedOff.subscribe((function(n){e.firedOff=n})),n.componentInstance.username=JSON.parse(l.a.getCookie("user")).username}}]),e}()).\u0275fac=function(e){return new(e||t)(d.Lb(w.g))},t.\u0275cmp=d.Fb({type:t,selectors:[["app-account-delete-user-btn"]],outputs:{isError:"isError"},decls:4,vars:3,consts:[[3,"loading"],["id","delete-user-btn","type","button","appBtn","","btnType","danger",3,"disabled","click"]],template:function(e,n){1&e&&(d.Ob(0),d.Mb(1,"app-gif-spinner",0),d.Rb(2,"button",1),d.dc("click",(function(e){return n.confirmDeletion()})),d.Hc(3),d.Pb(),d.Nb()),2&e&&(d.xb(1),d.nc("loading",n.loading),d.xb(1),d.nc("disabled",n.firedOff),d.xb(1),d.Jc(" ",n.btnText," "))},directives:[p.a,v.a],styles:["#delete-user-btn[_ngcontent-%COMP%]{cursor:pointer!important;display:inline-block!important}"]}),t);function k(e,n){1&e&&(d.Rb(0,"div",4),d.Hc(1," There was an error while trying to load your user information. Please try again later. "),d.Pb())}function O(e,n){if(1&e){var r=d.Sb();d.Rb(0,"div",28),d.Hc(1," If you do not enter a name, your name ("),d.Rb(2,"b"),d.Hc(3,"not"),d.Pb(),d.Hc(4," your user) will be deleted from the database. "),d.Rb(5,"button",29),d.dc("click",(function(e){return d.xc(r),d.gc(2).storeAlertState()})),d.Rb(6,"span",30),d.Hc(7,"\xd7"),d.Pb(),d.Pb(),d.Pb()}}function R(e,n){if(1&e&&(d.Ob(0),d.Rb(1,"div",31),d.Rb(2,"div",32),d.Hc(3),d.Pb(),d.Rb(4,"div",32),d.Hc(5),d.Pb(),d.Pb(),d.Nb()),2&e){d.gc();var r=d.vc(12),t=d.gc();d.xb(1),d.nc("hidden",!(r.touched&&r.invalid)),d.xb(1),d.nc("hidden",!(null!=r.errors&&r.errors.minlength)),d.xb(1),d.Jc(" Name is too short (min: 1, current: ",t.user.name.length,"). "),d.xb(1),d.nc("hidden",!(null!=r.errors&&r.errors.maxlength)),d.xb(1),d.Jc(" Name is too long (max: 100, current: ",t.user.name.length,"). ")}}function S(e,n){if(1&e&&(d.Ob(0),d.Rb(1,"div",31),d.Rb(2,"div",32),d.Hc(3),d.Pb(),d.Rb(4,"div",32),d.Hc(5),d.Pb(),d.Rb(6,"div",32),d.Hc(7," Username is required. "),d.Pb(),d.Pb(),d.Nb()),2&e){d.gc();var r=d.vc(18),t=d.gc();d.xb(1),d.nc("hidden",!(r.touched&&r.invalid)),d.xb(1),d.nc("hidden",!(null!=r.errors&&r.errors.minlength)),d.xb(1),d.Jc(" Username is too short (min: 3, current: ",t.user.username.length,"). "),d.xb(1),d.nc("hidden",!(null!=r.errors&&r.errors.maxlength)),d.xb(1),d.Jc(" Username is too long (max: 22, current: ",t.user.username.length,"). "),d.xb(1),d.nc("hidden",!(null!=r.errors&&r.errors.required))}}function I(e,n){if(1&e&&(d.Ob(0),d.Rb(1,"div",31),d.Rb(2,"div",32),d.Hc(3),d.Pb(),d.Rb(4,"div",32),d.Hc(5),d.Pb(),d.Rb(6,"div",32),d.Hc(7," Password is required. "),d.Pb(),d.Pb(),d.Nb()),2&e){d.gc();var r=d.vc(24),t=d.gc();d.xb(1),d.nc("hidden",!(r.touched&&r.invalid)),d.xb(1),d.nc("hidden",!(null!=r.errors&&r.errors.minlength)),d.xb(1),d.Jc(" Password is too short (min: 6, current: ",t.user.password.length,"). "),d.xb(1),d.nc("hidden",!(null!=r.errors&&r.errors.maxlength)),d.xb(1),d.Jc(" Password is too long (max: 256, current: ",t.user.password.length,"). "),d.xb(1),d.nc("hidden",!(null!=r.errors&&r.errors.required))}}function M(e,n){1&e&&(d.Ob(0),d.Hc(1," The username you chose already belongs to another user. "),d.Nb())}function H(e,n){1&e&&(d.Hc(0," There was an error while trying to update your account."),d.Mb(1,"br"),d.Hc(2,"Please try again later. "))}function E(e,n){if(1&e&&(d.Rb(0,"div",33),d.Fc(1,M,2,0,"ng-container",34),d.Fc(2,H,3,0,"ng-template",null,35,d.Gc),d.Pb()),2&e){var r=d.vc(3),t=d.gc(2);d.xb(1),d.nc("ngIf",t.userExists)("ngIfElse",r)}}function F(e,n){1&e&&(d.Rb(0,"div",36),d.Hc(1," Oops, looks like there was an error while trying to delete your user."),d.Mb(2,"br"),d.Hc(3,"Please try again later. "),d.Pb())}function T(e,n){if(1&e){var r=d.Sb();d.Rb(0,"form",5,6),d.dc("ngSubmit",(function(e){return d.xc(r),d.gc().save()})),d.Rb(2,"fieldset"),d.Rb(3,"legend",7),d.Hc(4,"Account"),d.Pb(),d.Fc(5,O,8,0,"div",8),d.Rb(6,"div",9),d.Rb(7,"div",10),d.Ob(8),d.Rb(9,"label",11),d.Hc(10,"Name"),d.Pb(),d.Rb(11,"input",12,13),d.dc("ngModelChange",(function(e){return d.xc(r),d.gc().user.name=e})),d.Pb(),d.Fc(13,R,6,5,"ng-container",14),d.Nb(),d.Ob(14),d.Rb(15,"label",15),d.Hc(16,"Username"),d.Pb(),d.Rb(17,"input",16,17),d.dc("ngModelChange",(function(e){return d.xc(r),d.gc().user.username=e})),d.Pb(),d.Fc(19,S,8,6,"ng-container",14),d.Nb(),d.Ob(20),d.Rb(21,"label",18),d.Hc(22,"Password"),d.Pb(),d.Rb(23,"input",19,20),d.dc("ngModelChange",(function(e){return d.xc(r),d.gc().user.password=e})),d.dc("focus",(function(e){return d.xc(r),d.gc().pwFocused=!0})),d.dc("blur",(function(e){return d.xc(r),d.gc().pwFocused=!1})),d.Pb(),d.Fc(25,I,8,6,"ng-container",14),d.Nb(),d.Pb(),d.Rb(26,"button",21),d.dc("click",(function(e){return d.xc(r),d.gc().sanitizeData()})),d.Hc(27," Save "),d.Pb(),d.Pb(),d.Pb(),d.Fc(28,E,4,2,"div",22),d.Rb(29,"div",23),d.Mb(30,"fa-icon",24),d.Hc(31," Updating your user data will log you out. "),d.Pb(),d.Fc(32,F,4,0,"div",25),d.Rb(33,"div",26),d.Mb(34,"app-update-roms"),d.Rb(35,"app-account-delete-user-btn",27),d.dc("isError",(function(e){return d.xc(r),d.gc().deletionError(e)})),d.Pb(),d.Pb(),d.Pb()}if(2&e){var t=d.vc(1),i=d.gc();d.xb(5),d.nc("ngIf",!i.noticeClosed),d.xb(6),d.nc("ngModel",i.user.name),d.xb(2),d.nc("ngIf",null!==i.user.name),d.xb(4),d.nc("ngModel",i.user.username),d.xb(2),d.nc("ngIf",i.user.hasOwnProperty("username")),d.xb(4),d.nc("type",i.changePwInputType())("ngModel",i.user.password),d.xb(2),d.nc("ngIf",i.user.hasOwnProperty("password")),d.xb(1),d.nc("disabled",i.firedOff||!t.valid||!(i.user.username||i.user.username.length>0||i.user.password||i.user.password.length>0||i.user.name||i.user.name.length>0)),d.xb(2),d.nc("ngIf",i.updateFail),d.xb(2),d.nc("icon",i.faExclamationTriangle),d.xb(2),d.nc("ngIf",i.isErrorDeleting)}}var U,_,D=((U=function(){function e(n,r){_classCallCheck(this,e),this.userService=n,this.router=r,this.updateFail=!1,this.ready=!1,this.pwFocused=!1,this.errLoadingUsr=!1,this.userExists=!1,String.prototype.sanitizeXSS=s.a,String.prototype.removeStringChars=c.a}return _createClass(e,[{key:"ngOnInit",value:function(){this.firedOff=!1,this.isErrorDeleting=!1,this.faExclamationTriangle=o.e,l.a.getCookie("user")?(this.userId=JSON.parse(l.a.getCookie("user")).id,this.retrieveUserData(this.userId)):this.errLoadingUsr=!0,localStorage.getItem("noticeClosed")||localStorage.setItem("noticeClosed","false"),this.noticeClosed=JSON.parse(localStorage.getItem("noticeClosed"))}},{key:"ngAfterContentInit",value:function(){window.scrollTo(0,0)}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}},{key:"retrieveUserData",value:function(e){var n=this;this.userObs$=this.userService.getUser(e),this.userSub=this.userObs$.subscribe((function(e){e.name&&""!==e.name||(e.name=""),e.password="",n.user=e,n.ready=!0}),(function(e){n.errLoadingUsr=!0,n.ready=!0,u.a.error(e)}))}},{key:"save",value:function(){this.firedOff=!0,this.ready=!1;var e=["error","user_exists"];this.user.name&&""!==this.user.name||(this.user.name=null),null===this.user.name?this.patchUser(this.userId,this.user,e):this.updateUser(this.userId,this.user,e)}},{key:"sanitizeData",value:function(){this.user.name&&(this.user.name=this.user.name.sanitizeXSS({replaceSpecialChars:!0}).removeStringChars()),this.user.username&&(this.user.username=this.user.username.sanitizeXSS({replaceSpecialChars:!1}).removeStringChars()),this.user.password&&(this.user.password=this.user.password.sanitizeXSS({replaceSpecialChars:!1}).removeStringChars())}},{key:"changePwInputType",value:function(){return this.pwFocused?"text":"password"}},{key:"deletionError",value:function(e){this.isErrorDeleting=e}},{key:"storeAlertState",value:function(){localStorage.setItem("noticeClosed","true")}},{key:"updateUser",value:function(e,n,r){var t=this;this.userService.updateUser(e,n).subscribe((function(){t.ready=!0,t.userExists=!1,a.a.logout(),t.router.navigate(["/","home"])}),(function(e){t.ready=!0,t.updateFail=!0,t.firedOff=!1,!0===e[r[0]][r[1]]&&(t.userExists=!0),u.a.error(e)}))}},{key:"patchUser",value:function(e,n,r){var t=this;this.userService.patchUser(e,n).subscribe((function(){t.ready=!0,t.userExists=!1,a.a.logout(),t.router.navigate(["/","home"])}),(function(e){t.ready=!0,t.firedOff=!1,t.updateFail=!0,!0===e[r[0]][r[1]]&&(t.userExists=!0),u.a.error(e)}))}}]),e}()).\u0275fac=function(e){return new(e||U)(d.Lb(b.a),d.Lb(m.b))},U.\u0275cmp=d.Fb({type:U,selectors:[["app-account"]],decls:5,vars:3,consts:[[3,"loading"],["id","form-container",1,"container","text-center","mb-2"],["appAlert","","alertType","danger","class","mt-3",4,"ngIf"],["name","accountForm","autocomplete","on",3,"ngSubmit",4,"ngIf"],["appAlert","","alertType","danger",1,"mt-3"],["name","accountForm","autocomplete","on",3,"ngSubmit"],["accountForm","ngForm"],[1,"pt-2","pb-2","text-center"],["class","alert-dismissible fade show text-left","appAlert","","alertType","info","role","alert",4,"ngIf"],["id","border-container",1,"border","rounded"],[1,"form-group"],["for","name",1,"font-weight-bold"],["placeholder","min: 1, max: 100 (optional)","type","text","id","name","name","name","autocomplete","name","minlength","1","maxlength","100",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],[4,"ngIf"],["for","username",1,"font-weight-bold","pt-1"],["placeholder","min: 3, max: 22","type","text","id","username","name","username","autocomplete","username","minlength","3","maxlength","22","required","",1,"form-control",3,"ngModel","ngModelChange"],["username","ngModel"],["for","password",1,"font-weight-bold"],["placeholder","min: 6, max: 256","id","password","name","password","autocomplete","new-password","minlength","6","maxlength","256","required","",1,"form-control",3,"type","ngModel","ngModelChange","focus","blur"],["password","ngModel"],["type","submit","appBtn","","btnType","success",3,"disabled","click"],["class","mt-2","appAlert","","alertType","danger",4,"ngIf"],["appAlert","","alertType","warning",1,"mt-3","mb-3","font-weight-bold"],[1,"mr-1",3,"icon"],["class","mt-1","appAlert","","alertType","danger",4,"ngIf"],[1,"d-flex","flex-column"],[3,"isError"],["appAlert","","alertType","info","role","alert",1,"alert-dismissible","fade","show","text-left"],["type","button","data-dismiss","alert","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],["appAlert","","alertType","warning",3,"hidden"],[3,"hidden"],["appAlert","","alertType","danger",1,"mt-2"],[4,"ngIf","ngIfElse"],["normalErrMsg",""],["appAlert","","alertType","danger",1,"mt-1"]],template:function(e,n){1&e&&(d.Ob(0),d.Mb(1,"app-gif-spinner",0),d.Rb(2,"div",1),d.Fc(3,k,2,0,"div",2),d.Fc(4,T,36,12,"form",3),d.Pb(),d.Nb()),2&e&&(d.xb(1),d.nc("loading",!n.ready&&!n.errLoadingUsr),d.xb(2),d.nc("ngIf",n.errLoadingUsr),d.xb(1),d.nc("ngIf",n.ready&&!n.errLoadingUsr))},directives:[p.a,f.n,g.a,h.u,h.m,h.n,h.a,h.i,h.h,h.l,h.o,h.r,v.a,y.a,x.a,C],styles:["#form-container[_ngcontent-%COMP%]{margin:0 auto;padding-top:1rem;width:32vw}@media only screen and (min-width:100px)and (max-width:992px){#form-container[_ngcontent-%COMP%]{width:45vw}}@media only screen and (min-width:991px)and (max-width:762px){#form-container[_ngcontent-%COMP%]{width:55vw}}@media only screen and (min-width:761px)and (max-width:703px){#form-container[_ngcontent-%COMP%]{width:63vw}}@media only screen and (min-width:0)and (max-width:702px){#form-container[_ngcontent-%COMP%]{width:70vw}}#border-container[_ngcontent-%COMP%]{background-color:#fff;padding:14px}label[_ngcontent-%COMP%]{padding-top:1rem}"]}),U),N=r("UTcu"),A=r("Dat7"),J=[{path:"",component:D,canActivate:[N.a,A.a]}],L=((_=function e(){_classCallCheck(this,e)}).\u0275mod=d.Jb({type:_}),_.\u0275inj=d.Ib({factory:function(e){return new(e||_)},imports:[[m.f.forChild(J)],m.f]}),_),q=r("t52u"),B=r("WjtB"),z=r("FUS3");r.d(n,"AccountModule",(function(){return j}));var X,j=((X=function e(){_classCallCheck(this,e)}).\u0275mod=d.Jb({type:X}),X.\u0275inj=d.Ib({factory:function(e){return new(e||X)},providers:[b.a,q.a],imports:[[f.b,w.h,L,B.a,h.g,y.b,z.a]]}),X)}}]);